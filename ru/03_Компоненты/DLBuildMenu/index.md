# DLBuildMenu: параметры и шаблоны
>Сниппет вывода меню **DLBuildMenu**, основанный на _DocLister_, предоставляет мощные инструменты создания меню сайта на MODx Evo. Но многие, даже опытные, MODx-юзеры не применяют DLBuildMenu &mdash; не в последнюю очередь из-за _отсутствия документации_. Восполняю этот пробел.

## Краткое описание
**DLBuildMenu** &mdash; сниппет для **вывода меню** сайта на MODx Evolution. Построен на основе ДокЛистера, по сути это сниппет-обертка с вызовом DocLister внутри &mdash; поэтому в нём можно использовать практически все параметры и фишки самого DocLister.

Применяя _prepare_, мы получаем неограниченные возможности подготовки данных. А развитая _система шаблонизации_ ДокЛистер, дополненная в DLBuildMenu новыми параметрами, даёт в руки, на мой взгляд, даже чрезмерно богатый инструментарий.

**Разработчик:** :godmode: [Agel_Nash](https://github.com/AgelxNash)


### :large_orange_diamond: Зависимости и требования

- Для работы DLBuildMenu у вас должен быть установлен _DocLister_ (есть в последних релизах MODx Evo _по умолчанию_).
- Требуется PHP не ниже _версии 5.4_ (в новых версиях Evo CMS лучше использовать _версию 5.6_ и выше).




### :large_orange_diamond: Установка

- DLBuildMenu входит _по умолчанию_ во все новые версии Evo CMS, начиная со сборки MODx Evo 1.2.1-d9.1.2 от 21.03.2017.
- На более старых сборках для его установки нужно _установить_ или _переустановить_ ДокЛистер из Extras, при этом&nbsp;нужно, чтобы DLBuildMenu был&nbsp;_отмечен_&nbsp;галочкой в списке при установке.




### :large_orange_diamond: Файлы

- assets/snippets/DocLister/snippet.DLBuildMenu.php
- assets/snippets/DocLister/lib/DLFixedPrepare.class.php (метод buildMenu)




### :large_orange_diamond: Преимущества DLBuildMenu

- есть возможность применения _prepare_&nbsp;для обработки данных перед выводом.
- _богатый выбор_ способов задания шаблонов, в том числе _инлайн-шаблоны_.
- _сортировка_ по TV-параметрам с приведением к нужному типу.
- может делать _фильтрацию_ по TV-параметрам.
- можно придумывать и задавать _собственные_ параметры и обрабатывать их в prepare.


## Параметры
### :large_orange_diamond: Базовые параметры
#### :small_orange_diamond: &amp;idType (hardcoded)
Тип выборки аналогично DocLister.

**Возможные значения:**&nbsp;`parents`

**Примечание:**&nbsp;значение параметра _&amp;idType_ жестко записано в коде как _parents_.

#### :small_orange_diamond: &amp;parents
Родительская (начальная) папка.

**Возможные значения:**&nbsp;_ID_ родителя, либо список _ID_ родителей через запятую.

**Значение по умолчанию:**&nbsp;`0`

**Примечание:** Обратите внимание, что в DLBuildMenu значение _&amp;parents_ по умолчанию равно _0_, что означает &laquo;выводить начиная с корня сайта&raquo;. Это отличается от дефолтного значения _&amp;parents_ параметра в ДокЛистере.

#### :small_orange_diamond: &amp;currentDepth
Исходный уровень вложенности (глубина).

**Возможные значения:** целое число от _1_ и больше.

**Значение по умолчанию:** `1`

#### :small_orange_diamond: &amp;maxDepth
Макс. глубина

**Возможные значения:** целое число от 1 и больше.

**Значение по умолчанию:** `5`

#### :small_orange_diamond: &amp;BeforePrepare и&nbsp;&amp;AfterPrepare
Обработка данных через prepare аналогично DocLister.

**Возможные значения:**&nbsp;задаются по правилам ДокЛистера. Могут быть списком имен сниппетов и вызовов методов ренее загруженных классов, либо анонимной функцией.

**Примечание:** для prepare в DLBuildMenu уже имеется встроенный обязательный вызов _DLFixedPrepare::buildMenu_. Обработчики из _&amp;BeforePrepare_ вызываются перед встроенным, из _&amp;AfterPrepare_ - после встроенного вызова.

#### :small_orange_diamond: &amp;activeClass
CSS-класс активного (текущего) пункта меню и его родительских элементов всех уровней.

**Возможные значиения:** Имя CSS-класса, или несколько имён CSS-классов, заданные как в HTML-теге (через пробел).

**Значение по умолчанию:**&nbsp;`active`

**Примечание:**&nbsp;этот CSS-класс и &nbsp;этот параметр существуют в дополнение к уже имеющимся в ДокЛистере классам _first_, _last_, _odd_, _even_ и _current_&nbsp;и соответствующим параметрам для них (см. документацию по DocLIster).

### :large_orange_diamond: Параметры условий выборки
#### :small_orange_diamond: &amp;addWhereList
Условия выборки документов для всех уровней.

**Возможные значения:** задаются как в DocLister (по правилам MySQL для условия WHERE).

**Значение по умолчанию:**&nbsp;`c.hidemenu = 0`

#### :small_orange_diamond: &amp;addWhereListN
Условия выборки документов N-го уровня, для соответствующих уровней&nbsp;_&amp;addWhereListN_&nbsp;имеет приоритет над _&amp;addWhereList_.

**Возможные значения:** задаются по правилам MySQL для условия WHERE.

**Значение по умолчанию:** нет

**Примечание:** Если _&amp;addWhereListN_ не задан, для всех уровней используется _&amp;addWhereList_.

### :large_orange_diamond: Параметры сортировки
#### :small_orange_diamond: &amp;orderBy
Условия сортировки документов всех уровней

**Возможные значения:** задаются как в DocLister (по правилам MySQL для ORDER BY).

**Значение по умолчанию:** &nbsp;`menuindex ASC, id ASC`

#### :small_orange_diamond: &amp;orderByN
Условия сортировки документов N-го уровня вложенности, для соответствующих уровней&nbsp;_&amp;orderBy_&nbsp;имеет приоритет над _&amp;orderBy_.

**Возможные значения:** задаются по правилам MySQL для ORDER BY.

**Значение по умолчанию:** нет

**Примечание:**&nbsp;Если _&amp;orderByN_&nbsp;не задан, для всех уровней используется _&amp;orderBy_.

### :large_orange_diamond: Параметр &laquo;список TV&raquo;
#### :small_orange_diamond: &amp;tvList
Список TV-параметров, которые участвуют в выборке (как в DocLister).

**Возможные значения:** список имён TV-параметров через запятую.

**Значение по умолчанию:**&nbsp;нет

#### :small_orange_diamond: &amp;tvListN
Список TV-параметров в выборке для N-го уровня вложенности, для соответствующих уровней&nbsp;_&amp;tvListN_&nbsp;имеет приоритет над&nbsp;_&amp;tvList_.

**Возможные значения:** список имён TV-параметров через запятую.

**Значение по умолчанию:** пусто.

**Примечание:**&nbsp;Если _&amp;tvListN_ не задан, для всех уровней используется _&amp;tvList_.
