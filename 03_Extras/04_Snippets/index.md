#Сниппеты в MODx EVO

##Что такое сниппет?

Сниппеты - это фрагменты php-кода, они используются для добавления логики на вебсайты: для создания меню, для определения залогиненных пользователей, для вывода списков статей и реализации любых других функций. В сниппетах могут быть использованы методы API MODx.

###Вызов сниппетов из HTML-кода

Сниппет можно вызвать прямо из HTML-кода (например из шаблона страницы или из чанка)

**Кешируемый вызов:**
```
[[snippetName]]
```
**Некешируемый вызов:**
```
[!snippetName!]
```
При вызове сниппету можно передать параметры

**Вызов с параметрами (кешируемый):**
```
[[mySnippet? &dogName = `Альфа` &dogBreed = `дворняга`]]
```

##Вызов сниппета через MODx API

Также сниппет можно вызвать через MODx API:

####Пример

```php
$modx->runSnippet('snippetName' [, $params]);
```

Первый аргумент **snippetName** - обязательный. Второй аргумент необязательный - это параметры, которые вы можете передать в сниппет в виде ассоциативного массива.

```php
$params => array('dogName' => 'Альфа', 'dogBreed' => 'дворняга');
$modx->runSnippet('mySnippet', $params);
```

В коде сниппета **mySnippet** параметры доступны через массив $params и через соответствующие переменные ($dogName, $dogBreed). Помимо этого, для доступа ко всем параметрам можно использовать и объект $modx:

```php
// внутри сниппета "mySnippet"
print $dogName; // выведет 'Альфа'
print_r( $params ); // выведет array('dogName' => 'Альфа', 'dogBreed' => 'дворняга');
print_r( $modx->event->params ); // выведет array('dogName' => 'Альфа', 'dogBreed' => 'дворняга');
```
Примечание: переменные для пар ключ/значение из массива параметров создаются [PHP-функцией extract](http://php.net/manual/ru/function.extract.php) с флагом EXTR_SKIP

####Пример 2
Часто требуется задавать параметры для вызова сниппетов динамически. Например, требуется выводить документы с возможностью выбрать родителя из формы, при этом вывод должен отличаться для анонимных и авторизованных пользователей. Можно писать отдельные сниппеты для формирования каждого параметра и делать вызов:
```
[!DocLister?
&parents=`[!getParents? &default=`5`!]`
&tpl=`[!getTpl? &registeredUsersTpl=`шаблон для авторизованных  пользователей`!]`
&paginate=`pages`
!]
```

Но будет удобнее, если объединить все в одном сниппете:
```php
$params['parents'] = isset($_GET['parents']) && is_int($_GET['parents']) && ($_GET['parents'] > 0) ? $_GET['parents'] : $params['parents'];
$params['tpl'] = $modx->getLoginUserID('web) ? $params['registeredUsersTpl'] : $params['tpl'];
return $modx->runSnippet('DocLister',$params);
```

Вызов:
```
[!MySnippet?
&parents=`5`
&tpl=`шаблон для анонимных пользователей`
&registeredUsersTpl=`шаблон для авторизованных пользователей`
&paginate=`pages`
!]
```

##Также смотрите

* http://wiki.modxcms.com/index.php/API:runSnippet
* http://wiki.modxcms.com/index.php/API:evalSnippet
