##Общие параметры

Эти параметры обрабатываются базовым классом FormLister. В контроллерах некоторые общие параметры могут иметь другое назначение.

##Настройки
###controller
Задает класс для обработки данных. 

Возможные значения - имя php-файла без расширения.

Значение по умолчанию - Form.

###dir
Папка в которой находится класс контроллера.

Значение по умолчанию - assets/snippets/FormLister/core/controller/

###formid
Имя формы, обязательный параметр.

В шаблоне формы обязательно должно быть скрытое поле с именем formid и значением, указанным в параметре. Форма считается отправленной, если в массиве $_REQUEST присутствует ключ с именем параметра, а его значение соответствует значению параметра.

###config
Загрузка параметров в формате json из файла.

Возможные значения - имяфайла:папка, несколько значений разделяются точкой с запятой.

####Пример
myparams:core - загрузить параметры из файла assets/snippets/FormLister/config/core/myparams.json; myparams - загрузить параметры из файла assets/snippets/FormLister/config/custom/myparams.json; myparams:myfolder - загрузить параметры из файла myfolder/myparams.json.

Значение по умолчанию - пусто.

###api
Определяет, в каком виде будут выводиться данные.

Возможные значения:

- 0: только заполненные данными шаблоны;
- 1: json-массив с данными формы;
- 2: json-массив с данными формы и заполненным шаблоном.

###debug
Режим отладки. Вывод записывается в лог MODX.

Возможные значения - 0, 1.

Значение по умолчанию - 0.

###saveObject
Сохраняет объект класса FormLister в плейсхолдер, который можно использовать в других сниппетах. Объект сохраняется только при успешной обработке формы.

Возможные значения - имя плейсхолдера.

Значение по умолчанию - пусто.

##Источники данных
###defaultsSources
Позволяет загружать дополнительные данные для обработки из внешних источников. По умолчанию внешние данные загружаются только при начальном выводе формы и не загружаются после отправки формы Это поведение может быть изменено с помощью параметра keepDefaults.

Данные из внешних источников загружаются только если источник является ассоциативным массивом.

На практике этот параметр можно использовать для предварительного заполнения полей формы.

Возможные значения: список источников, разделенных точкой с запятой. Загрузка данных производится в том порядке, в котором они указаны в списке. Данные из внешних источников всегда разрешены для обработки.

Источник может задаваться в формате имя:ключ:префикс. Префикс, если указан, добавляется c точкой к имени поля - например, config.site_name.

Возможные значения:

- array: json или php-массив, значения задаются параметром defaults;
- param:ключ:префикс - значения задаются значением параметра из вызова сниппета (аналогично array, только значение задается не параметром defaults, а произвольным);
- session:ключ:префикс - значения загружаются из массива $_SESSION;
- plh:ключ:префикс - значения загружаются из массива $modx->placeholders;
- config:префикс - загружаются значения параметров сниппета, ключ не нужен;
- cookie:ключ:префикс - загружаются значения массива $_COOKIE;
- имя класса MODxAPI:ключ:префикс - ключ является аргументом метода edit(), класс должен быть заранее загружен.

Значение по умолчанию: array.

###defaults
Данные для источника array.

Возможные значения: массив значений по умолчанию, в формате json или php.

###keepDefaults
Позволяет повторно загружать данные из внешних источников после отправки формы. Если в параметре указан список полей, то загружены будут только указанные поля.

Возможные значения: 1, 0, имена полей, разделенные запятой.

Значение по умолчанию - 0.

###allowEmptyFields
Разрешает поля с пустыми значениями.

Возможные значения - 0 или 1.

Значение по умолчанию - 1.

##Элементы управления
###formControls
Список полей с управляющими элементами формы (списки, чекбоксы, радио-кнопки). Необходимо для отслеживания состояния элементов.

Возможные значения - имена полей, разделенные запятой.

Значение по умолчанию - пусто.

###emptyFormControls

Этот параметр позволяет решить проблему неотмеченных чекбоксов, которые не включаются в массив полей при отправке формы: если в $_REQUEST отсутствует нужный элемент, то он создается согласно данному параметру. Необходимость в таком параметре возникла в связи с тем, что MODxAPI требует явно указывать изменяемые поля в методе fromArray(). Но можно использовать и в обычных формах, чтобы подставить в шаблон значение неотмеченного чекбокса. 

Возможные значения - json-массив:
```
&emptyFormControls=`{
    "mycheckbox" : "Нет",
    "published" : 0
}`
```

##Обработка данных
###prepare, prepareProcess
Аналогично параметру prepare в DocLister. Сниппеты из параметра prepare выполняются после загрузки данных в форму, а сниппеты из параметра prepareProcess - после прохождения валидации. В сниппетах через переменную $FormLister доступен объект контроллера, а через массив $data - значения полей формы. Для изменения данных следует использовать в prepare-сниппетах методы контроллера (setField, setFields и т.д.)

Значение по умолчанию - пусто.

##Валидация
###validator
Имя класса для валидации данных. Класс должен быть предварительно загружен.

Значение по умолчанию: \FormLister\Validator.

###rules
Массив с правилами валидации.

Значение по умолчанию: пусто.

##Шаблоны
###formTpl
Шаблон формы. В шаблоне формы обязательно должно быть поле с именем formid и значением, указанным в параметре formid.

Возможные значения - имя шаблона, указанное по правилам задания шаблонов в DocLister.

Значение по умолчанию - пусто.

###arraySplitter

Разделитель для преобразования массивов в строку. 

Значение по умолчанию - точка с запятой.

###{field}Splitter
Разделитель для преобразования массивов в строку, но для отдельного поля {field}. Например: groupsSplitter - разделитель для массива из поля groups.

Если не задано, то используется значение параметра arraySplitter.

###errorTpl
Шаблон для вывода сообщений валидатора.

Возможные значения - имя шаблона, указанное по правилам задания шаблонов в DocLister.

Значение по умолчанию:
```
@CODE:<div class="error">[+message+]</div>
```

###requiredClass, errorClass
Имена классов для обозначения незаполненных (required) и неверно заполенных (error) полей.

Значение по умолчанию - required и error соответственно.

###{field}.requiredClass, {field}.errorClass
Позволяет задавать указанные выше классы для конкретных полей.

По умолчанию используются значения параметров requiredClass и errorClass.

###messagesTpl
Шаблон сообщений обработчика формы. В шаблоне выводятся группы сообщений (messages, required, error).

Возможные значения - имя шаблона, указанное по правилам задания шаблонов в DocLister.

Значение по умолчанию:
```
@CODE:<div class="form-messages">[+messages+]</div>
```

###messagesOuterTpl
Шаблон-обертка для группы произвольных сообщений.

Возможные значения - имя шаблона, указанное по правилам задания шаблонов в DocLister.

Значение по умолчанию:
```
@CODE: [+messages+]
```

###messagesRequiredOuterTpl
Шаблон-обертка для группы сообщений о незаполненных полях.

Возможные значения - имя шаблона, указанное по правилам задания шаблонов в DocLister.

Значение по умолчанию:
```
@CODE: [+messages+]
```

###messagesErrorOuterTpl
Шаблон-обертка для группы сообщений о неверно заполненных полях.

Возможные значения - имя шаблона, указанное по правилам задания шаблонов в DocLister.

Значение по умолчанию:
```
@CODE: [+messages+]
```

###messagesSplitter, messagesRequiredSplitter, messagesErrorSplitter
Разделитель сообщений в группе.

Возможные значения - произвольная строка.

Значение по умолчанию:
```
<br>
```

##Капча
###captcha
Имя класса генератора капчи. Если не задано, то капча не используется.

Возможные значения - modxCaptcha.

Значение по умолчанию - пусто.

###captchaField
Имя поля со значением капчи. Для поля автоматически создается правило валидации.

Значение по умолчанию - vericode.

###captcha
Имя поля с кодом капчи.

Значение по умолчанию - captcha.

###captchaWidth, captchaHeight
Ширина и высота картинки с капчей.

Возможные значения - число пикселей.

Значение по умолчанию - 100 и 60 соответственно.

###captchaInline
Определяет формат изображения капчи для подстановки в атрибут src. Если задан, то капча генерируется в формате base64, иначе генерируется ссылка на файл.

Возможные значения - 0, 1.

Значение по умолчанию - 1.

##Перенаправление после обработки
###redirectTo
Id страницы, на которую нужно выполнить перенаправление после успешной обработки формы. В api-режиме перенаправление не выполняется, но в массиве данных формы сохраняется абсолютная ссылка на целевую страницу (поле "redirectTo").

Возможные значения - число.

Значение по умолчанию - пусто.