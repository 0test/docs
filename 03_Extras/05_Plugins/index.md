#Плагины в MODx EVO

##Что такое плагин?

Плагины, как и сниппеты, представляют собой фрагменты php-кода, которые имеют доступ к API MODx. Однако большая разница в том, что сниппет исполняется там, где мы его вызываем, а плагины связаны с определенными **системными событиями**.

При запросе страницы MODx, в процессе синтаксического анализа этой страницы в определенных точках происходят разные системные события. И плагин может быть привязан к одному или нескольким из этих событий для выполнения требуемой функции. Плагины не ограничивается только обработкой для вывода на фронтэнд - есть много событий, которые доступны и в админке MODx.

##Примеры плагинов

Плагины могут применяться во множестве случае, ниже даны несколько примеров:

###Фильтр слов

**Описание:** Фильтрует слова в документе перед его отображением 
**Системное событие:** OnWebPagePrerender

####Код плагина

```php
$words = array("snippet", "template"); // слова для фильтрации

$e = &$modx->Event;
switch ($e->name) {
  case "OnWebPagePrerender":
    $o = &$modx->documentOutput; // получаем ссылку на documentOutput
    $o = str_replace($words,"<b>[filtered]</b>",$o); // заменяем слова
  break;
  
  default :
    return; // остановка здесь - эта строка очень важна
  break;
}
```

###Перенаправление, если страница не существует

**Описание:** Перенаправляет посетителя на выбранный документ и отправляет сообщение менеджеру 
**Системное событие:** OnPageNotFound 

**Конфигурация плагина:** 
```
&pg=Error Page;int; &mid=Mail To;string;
```

####Код плагина

```php
$e = &$modx->Event;

switch ($e->name) {
  case "OnPageNotFound":
    if(!$pg) $modx->sendErrorPage();
    else {
      if ($mid) {
        // отправляет сообщение в локальный ящик менеджера
        $docid = $modx->documentIdentifier;
        $subject = "Page not found";
        $msg = "Someone tried to access document id $docid";
        $modx->sendAlert("Error",$mid,0,$subject,$msg,0);
      }
      $url=$this->makeUrl($pg);
      $this->sendRedirect($url, 1);
      exit;
    }
  break;

  default :
    return; // остановка здесь
  break;
}
```

**Важно!** Несмотря на то, что плагины пишутся на php, код плагина не должен содержать открывающего/закрывающего тега php `<?php и ?>`.
