
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<h2>FormLister: Редактирование профиля пользователя</h2>

<p>Контроллер <span class="text-bold">Profile</span> позволяет авторизованным пользователям редактировать свои профили, в том числе менять пароль.</p>
<p>При изменении профиля следует проверять уникальность email. В контроллере предусмотрено соответствующее правило:</p>
<pre class="brush: html;">&amp;rules=`{
	"email":{
		"required":"Введите email",
		"email":"Неверный email",
		"custom":{
			"function":"\\FormLister\\Profile::uniqueEmail",
			"message":"Этот email уже использует другой пользователь"
		}
	}
}`</pre>
<p>Аналогично с полем username:</p>
<pre class="brush: html;">&amp;rules=`{
	"username":{
		"required":"Введите имя пользователя",
		"alphaNumeric":"Только буквы и цифры",
		"custom":{
			"function":"\\FormLister\\Profile::uniqueUsername",
			"message":"Имя уже занято"
		}
	}
}`</pre>
<p>Если поле с паролем пустое, то пароль остается прежний. После изменения пароля пользователь должен авторизоваться с новым паролем. Новый пароль сохраняется в поле user.password.</p>
<h2 class="page-header">Параметры</h2>
<h3 class="sub-header text-bold">model</h3>
<p>Класс для работы с пользователями.</p>
<p>Возможные значения - имя класса.</p>
<p>Значение по умолчанию - \modUsers</p>
<h3 class="sub-header text-bold">modelPath</h3>
<p>Путь к файлу класса для работы с пользователями.</p>
<p>Возможные значения - относительный путь к файлу.</p>
<p>Значение по умолчанию - assets/lib/MODxAPI/modUsers.php</p>
<h3 class="sub-header text-bold">allowedFields</h3>
<p>Разрешенные для обработки поля. Поля, не указанные в списке, игнорируются. Если пользователь меняет пароль, то в разрешенные поля добавляется поле password. Если у пользователей совпадают поля e-mail и username, то при изменении e-mail будет изменено и поле username, если значение этого поля не задано. В этом случае поле username будет добавлено в список разрешенных.</p>
<p>Если не задано, то разрешены все поля.</p>
<p>Возможные значения - имена полей формы, разделенные запятой. </p>
<p>Значение по умолчанию - пусто.</p>
<h3 class="sub-header text-bold">forbiddenFields</h3>
<p>Запрещенные для обработки поля. Поля, указанные в списке, игнорируются. Поля password и username исключаются из списка по аналогии с allowedFields.</p>
<p>Возможные значения - имена полей формы, разделенные запятой. </p>
<p>Значение по умолчанию - пусто.</p>
<h3 class="sub-header text-bold">preparePostProcess</h3>
<p>Позволяет выполнить обработку данных после сохранения.</p>
<p>Возможные значения - имена сниппетов, анонимные функции, статические методы загруженных классов.</p>
<p>Значение по умолчанию - пусто.</p>
<h3 class="sub-header text-bold">redirectTo</h3>
<p>Перенаправляет пользователя на указанную страницу после сохранения профиля.</p>
<p>Возможные значения - id целевой страницы.</p>
<p>Значение по умолчанию - пусто.</p>
<h3 class="sub-header text-bold">exitTo</h3>
<p>Перенаправляет неавторизованного пользователя на указанную страницу.</p>
<p>Возможные значения - id целевой страницы или массив.</p>
<p>Значение по умолчанию - пусто.</p>
<h3 class="sub-header text-bold">skipTpl</h3>
<p>Шаблон сообщения для неавторизованного пользователя.</p>
<p>Возможные значения - имя шаблона, указанное по правилам задания шаблонов в DocLister.</p>
<p>Значение по умолчанию - запись из лексикона Profile с ключом [+profile.default_skipTpl+]</p>
<h3 class="sub-header text-bold">successTpl</h3>
<p>Шаблон сообщения об успешном обновлении профиля. Если не задан, то генерируется сообщение об успешном сохранении формы.</p>
<p>Возможные значения - имя шаблона, указанное по правилам задания шаблонов в DocLister.</p>
<p>Значение по умолчанию - пусто.</p>